doctype html
html
	head
		link(rel='stylesheet', href='/stylesheet.css')
		title Scale The Test
		link(rel='import', href='/bower_components/paper-material/paper-material.html')
		link(rel='import', href='/bower_components/paper-input/paper-input-container.html')
		link(rel='import', href='/bower_components/paper-input/paper-input.html')
		link(rel='import', href='/bower_components/paper-card/paper-card.html')
		link(rel='import', href='/bower_components/paper-button/paper-button.html')
	body
		div#headerBar.
			Test Scaler

		div#dataEntry
			paper-card(elevation="2")
				paper-input(label="Test Total" auto-validate pattern="[0-9]*" error-message="Only Numbers!" id ="testTotal")

				paper-input(label="Curve Percentage" auto-validate pattern="[0-9]*" error-message="Only Numbers!" suffix="%" maxlength="2" id = "curve")
					div(suffix).
						%
			
				div#enterScores
					paper-input(label="Enter a Score, then press enter" auto-validate pattern="[0-9]*" error-message="Only Numbers!" id="enterInput") 
					script(type="text/javascript").
						var scores = [];
						var inp = document.getElementById("enterInput");
						inp.onkeypress = function(e){
							if(e.keyCode == '13'){
								val = inp.value;
								inp.value = "";
								scores.push(val);
								var list = document.getElementById("scoreList");
								var entry = document.createElement("li");
								entry.appendChild(document.createTextNode(val));
								entry.setAttribute("contenteditable", "true");
								list.appendChild(entry);
								
							}
						}

					paper-button(raised id = "calculate" onClick="calculate()") Calculate
						script(type="text/javascript").
							function calculate(){
								var scores = []
								var list = document.getElementById("scoreList");
								var items = list.getElementsByTagName("li");
								var curveInp = document.getElementById("curve");
								var totalInp = document.getElementById("testTotal");

								for(var i = 1; i < items.length; i++){
									scores.push(parseFloat(items[i].innerText));
								}
								scores.sort();
								console.log(scores);
								var mean = findMean(scores);
								var median = findMedian(scores);
								var mode = findMode(scores);
								var highest = scores[scores.length - 1];
								var lowest = scores[0];
								var curvePercent = parseInt(curveInp.value);
								var total = parseInt(testTotal.value);
								document.getElementById("highest").textContent = "Highest Score: " + highest;
								document.getElementById("mean").textContent = ;
								document.getElementById("median").textContent = ;
								document.getElementById().textContent = ;
								document.getElementById().textContent = ;
								console.log(total);
								console.log(curvePercent);

							}

							function findMedian(scores){
								if (scores.length % 2 == 1){
									return scores[Math.floor(scores.length / 2) + 1];
								}
								sum = scores[scores.length / 2] + scores[scores.length / 2 + 1];
								
								return sum / 2.0;
							}

							function findMean(scores){
								sum = 0;

								for(var i = 0; i < scores.length; i++){
									sum = sum + scores[i]
								} 
								return sum / scores.length;
							}

							function findMode(scores){
								if(scores.length == 0){
									return null;
								}	

								var modeMap = {};
								var modes = [scores[0]];
								var maxCount = 1;

								for(var i = 0; i < scores.length; i++){
									var el = scores[i];

									if(modeMap[el] == null)
										modeMap[el] = 1;
									else 
										modeMap[el]++;

									if(modeMap[el] > maxCount){
										modes[0]= [el];
										maxCount = modeMap[el]
									}

									else if (modeMap[el] == maxCount){
										modes.push(el);
										maxCount = modeMap[el];
									}
								}
								return modes;
							}

		div#dataDisplay		
				h1 Entered Scores
			div(class = "stats")
				paper-card#total Total: _________
				paper-card#mean Mean Score: _________
				paper-card#median Median Score: _________
			div(class="stats")
				paper-card#mode Mode Score: _________
				paper-card#highest Highest Score: _________
				paper-card#lowest Lowest Score: _________
				paper-card#scaleAmount Scale: _________